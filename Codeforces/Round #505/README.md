# Problem D

题目描述：给出n <= 700个点，每个点都有一个权值，当两个点之间的GCD大于1时，可以连一条边。试求是否存在一种连边方案，使所得图为一棵二叉搜索树

解题不在我的能力范围之内。。

标准解法为dp

维护三个数组$dp[n][n], \ L[n][n], \ R[n][n]$

$dp[l][r]$表示是否可以在范围$[l, r]$内构造出一棵二叉搜索树

$L[l][r]$表示是否可以以r为根结点，所在范围内的数据构造为r的左子树

$R[l][r]$表示是否可以以l为根结点，所在范围内的数据构造为l的右子树

```c++
for (int len = 1; len <= n; ++len) {
    for (int i = 1; i + len - 1 <= n; ++i) {
        r = i + len - 1;
        l = i;
        for (int mid = i; mid <= r; ++mid) {
            if (L[i][mid] && R[mid][r]) {
                dp[l][r] = 1;
                L[l][r + 1] |= G[mid][r + 1];
                R[l - 1][r] |= G[mid][l - 1];
            }
        }
    }
}
```

整体十分得巧妙