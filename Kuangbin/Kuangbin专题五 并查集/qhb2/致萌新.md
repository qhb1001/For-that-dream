[TOC]



# HDU3038

题目描述：给出一段包含n个元素的序列，初始各个元素的值未知。之后给出m个信息，格式为`l, r, sum`

表示范围是`[l, r]`范围元素的加和为`sum`

依题目中给定的信息次序处理，如果遇到矛盾的信息无视

要求统计给出的m条信息中的矛盾信息的个数。



解法：可以将题目整理到图论上面去，一连串相关的信息其实就是一条链，询问其中任意两点的信息，可以通过该两点距离父节点的距离来验证。即两点之间的距离是已知的，当且仅当它们处于同一条链当中。

但是对于两条链的合并如何处理呢？推导出一条普适的结论即可。

注意使用`find()`函数来进行路径压缩以及更新到达父节点的距离。

疑问：为什么在读入数据之后，需要将`l--`? 因为对于父节点可能存在该点的值已知，但是在将来的多次路径压缩中，出现坏值。应该保证父节点的val值为0



# POJ 1182 食物链

题目描述：现在给出三个种族A, B, C，已知它们之间的关系是A吃B，B吃C，C吃A，构成了一种奇妙的环状关系。现在给出`n`个动物构成的`m`组信息。信息分为两种，第一种的形式为`1 u v`，表示`u`与`v`为同类；第二种的形式为`2 u v`，表示`u`吃`v`。试统计有多少组矛盾信息。

矛盾信息分为三类：

* 表示的信息为 某种动物吃自己
* 表示的动物编号大于`n`
* 与前述信息矛盾的信息



解法：使用种类并查集来处理该问题。将并查集的大小扩大为原来的3倍。`[1, n]`表示A种族，`[n + 1, 2n`]表示B种族，`[2n + 1, 3n]`表示C种族。实际上这只是为了便于理解，只要可以构成环形的关系即可。

* 在给定的一组关系中，一个对象可能处于这三个种族的任意一个，所以当给定一个关系时，有必要在此处的三个可能中进行更新。

* 一个标号为`x`的对象在三个种族总都存在投影，分别为`x`, `x + n`, `x + 2n`

* 如果有`find(x) == find(y + n)`，即x为A种族，y为B种族，它们处于同一个集合，那么表示x吃y

* 举例：表示一个同类关系`1 u v`时，需要更新三个关系

  `unit(u, v), unit(u + n, v + n), unit(u + 2n, v + 2n)`

  分别表示u v均为A种族并且同类，u v均为B种族并且同类，u v均为C种族并且同类

* 如何判断给定的信息与前述信息矛盾？以同类为例

  可能出现的不匹配现象是

  * u 吃 v

    `find(u) == find(v + n) || find(u + n) == find(v + 2 * n) || find(u + 2 * n) == find(v)`

  * v 吃 u

    `find(v) == find(u + n) || find(v + n) == find(u + 2 * n) || find(v + 2 * n) == find(u)`

    



# 洛谷 P1525

题目描述：给出m对矛盾关系，形式为`a, b, val`。如果将这两个对象放在同一个集合中，将会产生数值为`val`的矛盾值。要求构造一种分配方式，将n个元素分配到两个集合中，最小化最大矛盾值。



解法：大意与食物链一致，虽然有两个集合，但是不必要关心某个对象具体分配到了哪个集合中，因为只是一个参照的关系。所以两倍并查集的大小，`[1, n]`元素代表同类关系，`[n + 1, 2n]`代表对应的敌对关系。

* 第一个步骤很明显是排序
* 之后按照次序处理矛盾关系，有一点贪心的思想。如果可以化解矛盾，则化解矛盾，即将两者设置为敌对关系，也就是不放到同一个集合中
* 否则直接输出此时的矛盾值即可，可以保证此时的矛盾值即为不可调和的最大矛盾值。

